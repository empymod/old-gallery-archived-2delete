

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Transient CSEM for a homogeneous space &mdash; emg3d-gallery 0.12.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Transient CSEM for a marine model" href="marine_1D.html" />
    <link rel="prev" title="4. Magnetic permeability" href="../magnetics/magnetic_permeability.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo-emg3d-cut.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.12.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Example Gallery</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#examples-and-tutorials">Examples and Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#comparisons">Comparisons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#magnetic-fields-and-magnetic-permeability">Magnetic fields and magnetic permeability</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#time-domain">Time Domain</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">1. Transient CSEM for a homogeneous space</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#model-and-survey">Model and Survey</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fourier-transforms-parameters">Fourier Transforms parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#frequency-domain-computation">Frequency-domain computation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-fftlog">1. Using FFTLog</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-dlf">2. Using DLF</a></li>
<li class="toctree-l4"><a class="reference internal" href="#results-from-mulder-et-al-2008-geophysics">3. Results from Mulder et al., 2008, Geophysics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="marine_1D.html">2. Transient CSEM for a marine model</a></li>
<li class="toctree-l3"><a class="reference internal" href="freqselect.html">3. Interactive frequency selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tools">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#reproducing">Reproducing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#interactions">Interactions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../manual.html">Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">Links</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://empymod.github.io"><i class="fa fa-link fa-fw"></i> Website</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/empymod/emg3d-gallery"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">emg3d-gallery</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Gallery</a> &raquo;</li>
        
      <li>1. Transient CSEM for a homogeneous space</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/gallery/time_domain/fullspace.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="marine_1D.html" class="btn btn-neutral float-right" title="2. Transient CSEM for a marine model" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../magnetics/magnetic_permeability.html" class="btn btn-neutral float-left" title="4. Magnetic permeability" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gallery-time-domain-fullspace-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="transient-csem-for-a-homogeneous-space">
<span id="sphx-glr-gallery-time-domain-fullspace-py"></span><h1>1. Transient CSEM for a homogeneous space<a class="headerlink" href="#transient-csem-for-a-homogeneous-space" title="Permalink to this headline">¶</a></h1>
<p>Example how to use <code class="docutils literal notranslate"><span class="pre">emg3d</span></code> to model time-domain data, using FFTLog and DLF.</p>
<p>This example is based on the first example (Figures 3-4) of <a class="reference internal" href="../../references.html#muws08" id="id1"><span>[MuWS08]</span></a>, those
original results are shown at the bottom of this example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">emg3d</span>
<span class="kn">import</span> <span class="nn">empymod</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>

<span class="c1"># Name is used to store the data for each frequency.</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Fullspace&#39;</span>
</pre></div>
</div>
<div class="section" id="model-and-survey">
<h2>Model and Survey<a class="headerlink" href="#model-and-survey" title="Permalink to this headline">¶</a></h2>
<div class="section" id="model">
<h3>Model<a class="headerlink" href="#model" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Homogeneous fullspace of 1 Ohm.m.</p></li>
</ul>
</div>
<div class="section" id="survey">
<h3>Survey<a class="headerlink" href="#survey" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Source at origin.</p></li>
<li><p>Receiver at an inline-offset of 900 m.</p></li>
<li><p>Both source and receiver are x-directed electric dipoles.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">rec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">900</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>                  <span class="c1"># Fullspace resistivity</span>
<span class="n">depth</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="fourier-transforms-parameters">
<h2>Fourier Transforms parameters<a class="headerlink" href="#fourier-transforms-parameters" title="Permalink to this headline">¶</a></h2>
<p>We only compute frequencies <span class="math notranslate nohighlight">\(0.05 &lt; f &lt; 21\)</span> Hz, which yields enough
precision for our purpose.</p>
<p>This means, instead of 30 frequencies from 0.0002 - 126.4 Hz, we only need 14
frequencies from 0.05 - 20.0 Hz.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define desired times.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">logspace</span></a></a></a></a><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>

<span class="c1"># Initiate a Fourier instance</span>
<a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Fourier</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Fourier</span></a></a></a></a><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span>
    <span class="n">fmin</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">fmax</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span>
    <span class="n">ft</span><span class="o">=</span><span class="s1">&#39;fftlog&#39;</span><span class="p">,</span>  <span class="c1"># Fourier transform to use</span>
    <span class="n">ftarg</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pts_per_dec&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;add_dec&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
<span class="p">)</span>

<span class="c1"># Dense frequencies for comparison reasons</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">logspace</span></a></a></a></a><span class="p">(</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span><span class="o">.</span><span class="n">min</span></a></a></a></a><span class="p">()),</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span><span class="o">.</span><span class="n">max</span></a></a></a></a><span class="p">()),</span>
        <span class="mi">301</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>time        [s] :  0.01 - 10 : 201  [min-max; #]
Fourier         :  FFTLog
  &gt; pts_per_dec :  5
  &gt; add_dec     :  [-2.  1.]
  &gt; q           :  0.0
Req. freq  [Hz] :  0.000200364 - 126.421 : 30  [min-max; #]
Calc. freq [Hz] :  0.0503292 - 20.0364 : 14  [min-max; #]
</pre></div>
</div>
</div>
<div class="section" id="frequency-domain-computation">
<h2>Frequency-domain computation<a class="headerlink" href="#frequency-domain-computation" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># To store the info of each frequency.</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1">#</span>
<span class="n">gridinput</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">,</span>               <span class="c1"># Fullspace resistivity.</span>
    <span class="s1">&#39;min_width&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">],</span>  <span class="c1"># Restr. the cell width within the survey domain.</span>
    <span class="s1">&#39;return_info&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>      <span class="c1"># To get back some information for later.</span>
    <span class="s1">&#39;pps&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>                <span class="c1"># Many points, to have a small min cell width.</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>  <span class="c1"># Lower the alpha will improve the result, but</span>
    <span class="s1">&#39;verb&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>                <span class="c1"># slow down computation.</span>
<span class="p">}</span>
<span class="c1">#</span>
<span class="c1"># Start the timer.</span>
<span class="n">runtime</span> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Time.html#emg3d.utils.Time" title="emg3d.utils.Time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Time.html#emg3d.utils.Time" title="emg3d.utils.Time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Time.html#emg3d.utils.Time" title="emg3d.utils.Time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Time.html#emg3d.utils.Time" title="emg3d.utils.Time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">Time</span></a></a></a></a><span class="p">()</span>
<span class="c1">#</span>
<span class="c1"># Loop over frequencies, going from high to low.</span>
<a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">old_grid</span></a></a></a></a> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">fi</span><span class="p">,</span> <span class="n">frq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">fi</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">2</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span><span class="o">.</span><span class="n">size</span></a></a></a></a><span class="si">}</span><span class="s2"> :: </span><span class="si">{</span><span class="n">frq</span><span class="si">:</span><span class="s2">10.6f</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>

    <span class="c1"># Initiate log for this frequency.</span>
    <span class="n">thislog</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">thislog</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frq</span>

    <span class="c1"># Get cell widths and origin in each direction</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">xx</span></a></a></a></a><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">hix</span> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><span class="n">emg3d</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">get_hx_h0</span></a></a></a></a><span class="p">(</span>
        <span class="n">freq</span><span class="o">=</span><span class="n">frq</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">1100</span><span class="p">],</span> <span class="o">**</span><span class="n">gridinput</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">yz</span></a></a></a></a><span class="p">,</span> <span class="n">yz0</span><span class="p">,</span> <span class="n">hiyz</span> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><span class="n">emg3d</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">get_hx_h0</span></a></a></a></a><span class="p">(</span>
        <span class="n">freq</span><span class="o">=</span><span class="n">frq</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="n">src</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="o">**</span><span class="n">gridinput</span><span class="p">)</span>

    <span class="c1"># Store values in log.</span>
    <span class="n">thislog</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">hix</span><span class="p">[</span><span class="s1">&#39;amin&#39;</span><span class="p">],</span> <span class="n">hiyz</span><span class="p">[</span><span class="s1">&#39;amin&#39;</span><span class="p">]]),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">hix</span><span class="p">[</span><span class="s1">&#39;amax&#39;</span><span class="p">],</span> <span class="n">hiyz</span><span class="p">[</span><span class="s1">&#39;amax&#39;</span><span class="p">]])]</span>
    <span class="n">thislog</span><span class="p">[</span><span class="s1">&#39;dminmax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">hix</span><span class="p">[</span><span class="s1">&#39;dmin&#39;</span><span class="p">],</span> <span class="n">hiyz</span><span class="p">[</span><span class="s1">&#39;dmin&#39;</span><span class="p">]]),</span>
                          <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">hix</span><span class="p">[</span><span class="s1">&#39;dmax&#39;</span><span class="p">],</span> <span class="n">hiyz</span><span class="p">[</span><span class="s1">&#39;dmax&#39;</span><span class="p">]])]</span>

    <span class="c1"># Initiate mesh.</span>
    <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">TensorMesh</span></a></a></a></a><span class="p">([</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">xx</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">yz</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">yz</span></a></a></a></a><span class="p">],</span> <span class="n">x0</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a></a></a></a><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">yz0</span><span class="p">,</span> <span class="n">yz0</span><span class="p">]))</span>
    <span class="c1"># print(grid)</span>
    <span class="n">thislog</span><span class="p">[</span><span class="s1">&#39;nC&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nC" title="discretize.TensorMesh.nC" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nC" title="discretize.TensorMesh.nC" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nC" title="discretize.TensorMesh.nC" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nC" title="discretize.TensorMesh.nC" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid</span><span class="o">.</span><span class="n">nC</span></a></a></a></a>  <span class="c1"># Store number of cells in log.</span>

    <span class="c1"># Interpolate the starting electric field from the last one (can speed-up</span>
    <span class="c1"># the computation).</span>
    <span class="k">if</span> <span class="n">fi</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">efield</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Field</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">frq</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">efield</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.maps.grid2grid.html#emg3d.maps.grid2grid" title="emg3d.maps.grid2grid" class="sphx-glr-backref-module-emg3d-maps sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.maps.grid2grid.html#emg3d.maps.grid2grid" title="emg3d.maps.grid2grid" class="sphx-glr-backref-module-emg3d-maps sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.maps.grid2grid.html#emg3d.maps.grid2grid" title="emg3d.maps.grid2grid" class="sphx-glr-backref-module-emg3d-maps sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.maps.grid2grid.html#emg3d.maps.grid2grid" title="emg3d.maps.grid2grid" class="sphx-glr-backref-module-emg3d-maps sphx-glr-backref-type-py-function"><span class="n">emg3d</span><span class="o">.</span><span class="n">maps</span><span class="o">.</span><span class="n">grid2grid</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">old_grid</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">efield</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span>
                                      <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">extrapolate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">efield</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Field</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">efield</span></a></a></a></a><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">frq</span><span class="p">)</span>

    <span class="c1"># Generate model</span>
    <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Model</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span> <span class="n">property_x</span><span class="o">=</span><span class="n">res</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="s1">&#39;Resistivity&#39;</span><span class="p">)</span>

    <span class="c1"># Define source.</span>
    <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfield</span></a></a></a></a> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">get_source_field</span><span class="p">(</span>
        <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span> <span class="p">[</span><span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">src</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">src</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">frq</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Solve the system.</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span>
        <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfield</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">efield</span></a></a></a></a><span class="o">=</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">efield</span></a></a></a></a><span class="p">,</span>
        <span class="n">verb</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">sslsolver</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">semicoarsening</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linerelaxation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Store info</span>
    <span class="n">thislog</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>

    <span class="c1"># Store value</span>
    <span class="n">thislog</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">get_receiver</span><span class="p">(</span>
            <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><span class="n">efield</span><span class="o">.</span><span class="n">fx</span></a></a></a></a><span class="p">,</span> <span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

    <span class="c1"># Store thislog in values.</span>
    <span class="n">values</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">frq</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)]</span> <span class="o">=</span> <span class="n">thislog</span>

    <span class="c1"># Store the grid for the interpolation.</span>
    <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">old_grid</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a>

<span class="c1"># Stop the timer.</span>
<span class="n">total_time</span> <span class="o">=</span> <span class="n">runtime</span><span class="o">.</span><span class="n">runtime</span>

<span class="c1"># Store data and info to disk</span>
<span class="n">emg3d</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.npz&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>   1/14 ::  20.036420 Hz
:: emg3d :: 3.8e-03; 0(1); 0:00:01
:: emg3d :: 2.3e-04; 0(2); 0:00:01
:: emg3d :: 5.0e-06; 0(3); 0:00:02
:: emg3d :: 1.2e-06; 0(4); 0:00:02
:: emg3d :: 2.0e-07; 0(5); 0:00:03
:: emg3d :: 1.9e-07; 1(5); 0:00:03
:: emg3d :: 1.9e-07; 1(5); 0:00:03; CONVERGED
   2/14 ::  12.642126 Hz
:: emg3d :: 1.1e-03; 0(1); 0:00:01
:: emg3d :: 7.2e-05; 0(2); 0:00:03
:: emg3d :: 1.5e-06; 0(3); 0:00:04
:: emg3d :: 4.9e-07; 0(4); 0:00:05
:: emg3d :: 4.3e-07; 1(4); 0:00:05
:: emg3d :: 4.3e-07; 1(4); 0:00:05; CONVERGED
   3/14 ::   7.976643 Hz
:: emg3d :: 1.5e-03; 0(1); 0:00:01
:: emg3d :: 1.6e-04; 0(2); 0:00:03
:: emg3d :: 5.6e-06; 0(3); 0:00:04
:: emg3d :: 1.7e-06; 0(4); 0:00:05
:: emg3d :: 3.6e-07; 0(5); 0:00:07
:: emg3d :: 3.5e-07; 1(5); 0:00:07
:: emg3d :: 3.5e-07; 1(5); 0:00:07; CONVERGED
   4/14 ::   5.032921 Hz
:: emg3d :: 1.9e-03; 0(1); 0:00:01
:: emg3d :: 2.9e-04; 0(2); 0:00:03
:: emg3d :: 1.5e-05; 0(3); 0:00:04
:: emg3d :: 4.0e-06; 0(4); 0:00:05
:: emg3d :: 9.1e-07; 0(5); 0:00:07
:: emg3d :: 8.9e-07; 1(5); 0:00:07
:: emg3d :: 8.9e-07; 1(5); 0:00:07; CONVERGED
   5/14 ::   3.175559 Hz
:: emg3d :: 1.9e-03; 0(1); 0:00:01
:: emg3d :: 3.1e-04; 0(2); 0:00:02
:: emg3d :: 2.4e-05; 0(3); 0:00:03
:: emg3d :: 4.9e-06; 0(4); 0:00:04
:: emg3d :: 1.1e-06; 0(5); 0:00:05
:: emg3d :: 9.1e-08; 0(6); 0:00:07
:: emg3d :: 8.3e-08; 1(6); 0:00:07
:: emg3d :: 8.3e-08; 1(6); 0:00:07; CONVERGED
   6/14 ::   2.003642 Hz
:: emg3d :: 1.9e-03; 0(1); 0:00:01
:: emg3d :: 2.7e-04; 0(2); 0:00:02
:: emg3d :: 1.6e-05; 0(3); 0:00:03
:: emg3d :: 3.7e-06; 0(4); 0:00:04
:: emg3d :: 8.3e-07; 0(5); 0:00:06
:: emg3d :: 8.2e-07; 1(5); 0:00:06
:: emg3d :: 8.2e-07; 1(5); 0:00:06; CONVERGED
   7/14 ::   1.264213 Hz
:: emg3d :: 1.8e-03; 0(1); 0:00:01
:: emg3d :: 2.9e-04; 0(2); 0:00:02
:: emg3d :: 2.1e-05; 0(3); 0:00:03
:: emg3d :: 3.8e-06; 0(4); 0:00:04
:: emg3d :: 8.7e-07; 0(5); 0:00:04
:: emg3d :: 8.6e-07; 1(5); 0:00:04
:: emg3d :: 8.6e-07; 1(5); 0:00:04; CONVERGED
   8/14 ::   0.797664 Hz
:: emg3d :: 2.1e-03; 0(1); 0:00:01
:: emg3d :: 3.8e-04; 0(2); 0:00:02
:: emg3d :: 3.2e-05; 0(3); 0:00:03
:: emg3d :: 6.3e-06; 0(4); 0:00:04
:: emg3d :: 1.4e-06; 0(5); 0:00:04
:: emg3d :: 1.1e-07; 0(6); 0:00:05
:: emg3d :: 9.1e-08; 1(6); 0:00:05
:: emg3d :: 9.1e-08; 1(6); 0:00:05; CONVERGED
   9/14 ::   0.503292 Hz
:: emg3d :: 2.5e-03; 0(1); 0:00:01
:: emg3d :: 5.3e-04; 0(2); 0:00:02
:: emg3d :: 6.4e-05; 0(3); 0:00:03
:: emg3d :: 1.4e-05; 0(4); 0:00:04
:: emg3d :: 3.1e-06; 0(5); 0:00:04
:: emg3d :: 4.5e-07; 0(6); 0:00:05
:: emg3d :: 3.3e-07; 1(6); 0:00:05
:: emg3d :: 3.3e-07; 1(6); 0:00:05; CONVERGED
  10/14 ::   0.317556 Hz
:: emg3d :: 2.8e-03; 0(1); 0:00:01
:: emg3d :: 6.7e-04; 0(2); 0:00:02
:: emg3d :: 1.1e-04; 0(3); 0:00:03
:: emg3d :: 2.8e-05; 0(4); 0:00:04
:: emg3d :: 6.8e-06; 0(5); 0:00:04
:: emg3d :: 1.5e-06; 0(6); 0:00:05
:: emg3d :: 9.9e-07; 1(6); 0:00:05
:: emg3d :: 9.9e-07; 1(6); 0:00:05; CONVERGED
  11/14 ::   0.200364 Hz
:: emg3d :: 2.3e-03; 0(1); 0:00:01
:: emg3d :: 5.8e-04; 0(2); 0:00:03
:: emg3d :: 1.5e-04; 0(3); 0:00:04
:: emg3d :: 2.8e-05; 0(4); 0:00:06
:: emg3d :: 8.4e-06; 0(5); 0:00:07
:: emg3d :: 2.8e-06; 0(6); 0:00:08
:: emg3d :: 1.7e-06; 1(6); 0:00:08
:: emg3d :: 1.6e-07; 1(7); 0:00:10
:: emg3d :: 2.0e-07; 2(7); 0:00:10
:: emg3d :: 2.0e-07; 2(7); 0:00:10; CONVERGED
  12/14 ::   0.126421 Hz
:: emg3d :: 2.6e-03; 0(1); 0:00:01
:: emg3d :: 6.8e-04; 0(2); 0:00:03
:: emg3d :: 2.0e-04; 0(3); 0:00:04
:: emg3d :: 4.3e-05; 0(4); 0:00:06
:: emg3d :: 1.6e-05; 0(5); 0:00:07
:: emg3d :: 6.3e-06; 0(6); 0:00:08
:: emg3d :: 3.6e-06; 1(6); 0:00:08
:: emg3d :: 4.2e-07; 1(7); 0:00:10
:: emg3d :: 4.4e-07; 2(7); 0:00:10
:: emg3d :: 4.4e-07; 2(7); 0:00:10; CONVERGED
  13/14 ::   0.079766 Hz
:: emg3d :: 3.1e-03; 0(1); 0:00:02
:: emg3d :: 6.9e-04; 0(2); 0:00:03
:: emg3d :: 1.8e-04; 0(3); 0:00:05
:: emg3d :: 6.2e-05; 0(4); 0:00:07
:: emg3d :: 2.2e-05; 0(5); 0:00:09
:: emg3d :: 8.2e-06; 0(6); 0:00:10
:: emg3d :: 5.0e-06; 1(6); 0:00:10
:: emg3d :: 1.2e-06; 1(7); 0:00:12
:: emg3d :: 4.6e-07; 1(8); 0:00:14
:: emg3d :: 7.2e-07; 2(8); 0:00:14
:: emg3d :: 7.2e-07; 2(8); 0:00:14; CONVERGED
  14/14 ::   0.050329 Hz
:: emg3d :: 3.3e-03; 0(1); 0:00:02
:: emg3d :: 7.5e-04; 0(2); 0:00:03
:: emg3d :: 2.3e-04; 0(3); 0:00:05
:: emg3d :: 7.6e-05; 0(4); 0:00:07
:: emg3d :: 3.3e-05; 0(5); 0:00:08
:: emg3d :: 1.4e-05; 0(6); 0:00:10
:: emg3d :: 9.0e-06; 1(6); 0:00:10
:: emg3d :: 2.4e-06; 1(7); 0:00:12
:: emg3d :: 1.1e-06; 1(8); 0:00:13
:: emg3d :: 4.6e-07; 1(9); 0:00:15
:: emg3d :: 6.8e-07; 2(9); 0:00:15
:: emg3d :: 6.8e-07; 2(9); 0:00:15; CONVERGED
Data saved to «/home/dtr/Desktop/emg3d-gallery/examples/time_domain/Fullspace.npz»
[emg3d v0.12.0 (format 0.12.0) on 2020-07-29T22:45:55.741779].
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load info and data</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.npz&#39;</span><span class="p">)[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>

<span class="n">runtime</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">7.3f</span><span class="si">}</span><span class="s2"> Hz: &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;it_mg&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">2g</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;it_ssl&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2"> it; &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">4.0f</span><span class="si">}</span><span class="s2"> s; &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;a: </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ; &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;nC: </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;nC&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">8,.0f</span><span class="si">}</span><span class="s2">; &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;a: </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;dminmax&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">5.0f</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;dminmax&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">7.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">runtime</span> <span class="o">+=</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">                **** TOTAL RUNTIME :: &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">runtime</span><span class="o">//</span><span class="mi">60</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> min </span><span class="si">{</span><span class="n">runtime</span><span class="o">%</span><span class="mi">60</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s ****</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Data loaded from «/home/dtr/Desktop/emg3d-gallery/examples/time_domain/Fullspace.npz»
[emg3d v0.12.0 (format 0.12.0) on 2020-07-29T22:45:55.741779].
   20.036 Hz:  5/1 it;    3 s; a: 1.000 / 1.260 ; nC:   46,080; a:    20 /     160
   12.642 Hz:  4/1 it;    5 s; a: 1.000 / 1.170 ; nC:   98,304; a:    20 /     154
    7.977 Hz:  5/1 it;    7 s; a: 1.000 / 1.200 ; nC:   98,304; a:    20 /     214
    5.033 Hz:  5/1 it;    7 s; a: 1.000 / 1.230 ; nC:   98,304; a:    20 /     295
    3.176 Hz:  6/1 it;    7 s; a: 1.000 / 1.250 ; nC:   81,920; a:    24 /     428
    2.004 Hz:  5/1 it;    6 s; a: 1.000 / 1.210 ; nC:   81,920; a:    30 /     427
    1.264 Hz:  5/1 it;    4 s; a: 1.000 / 1.210 ; nC:   65,536; a:    37 /     538
    0.798 Hz:  6/1 it;    5 s; a: 1.000 / 1.230 ; nC:   65,536; a:    40 /     726
    0.503 Hz:  6/1 it;    5 s; a: 1.000 / 1.260 ; nC:   65,536; a:    40 /    1017
    0.318 Hz:  6/1 it;    5 s; a: 1.000 / 1.280 ; nC:   65,536; a:    40 /    1421
    0.200 Hz:  7/2 it;   10 s; a: 1.000 / 1.270 ; nC:  102,400; a:    40 /    1832
    0.126 Hz:  7/2 it;   10 s; a: 1.000 / 1.300 ; nC:  102,400; a:    40 /    2662
    0.080 Hz:  8/2 it;   14 s; a: 1.000 / 1.260 ; nC:  128,000; a:    40 /    2563
    0.050 Hz:  9/2 it;   15 s; a: 1.000 / 1.280 ; nC:  128,000; a:    40 /    3403

                **** TOTAL RUNTIME :: 1 min 42.6 s ****
</pre></div>
</div>
<div class="section" id="load-data-interpolate-at-receiver-location">
<h3>Load data, interpolate at receiver location<a class="headerlink" href="#load-data-interpolate-at-receiver-location" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initiate data with zeros.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span><span class="o">.</span><span class="n">size</span></a></a></a></a><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

<span class="c1"># Loop over frequencies.</span>
<span class="k">for</span> <span class="n">fi</span><span class="p">,</span> <span class="n">frq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">frq</span><span class="o">*</span><span class="mf">1e6</span><span class="p">))</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">[</span><span class="n">fi</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-fftlog">
<h2>1. Using FFTLog<a class="headerlink" href="#using-fftlog" title="Permalink to this headline">¶</a></h2>
<div class="section" id="interpolate-missing-frequencies-and-compute-analytical-result">
<h3>Interpolate missing frequencies and compute analytical result<a class="headerlink" href="#interpolate-missing-frequencies-and-compute-analytical-result" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><span class="n">Fourier</span><span class="o">.</span><span class="n">interpolate</span></a></a></a></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">)</span>

<span class="c1"># Compute analytical result using empymod (epm)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-frequency-domain-result">
<h3>Plot frequency-domain result<a class="headerlink" href="#plot-frequency-domain-result" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Real, log-lin</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">321</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(a) log-lin Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interpolated&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_x$ (nV/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Real, log-symlog</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">323</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(c) log-symlog Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_x$ (nV/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthreshy</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="c1"># Real, error</span>
<span class="n">ax5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">325</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(e) clipped 0.01-10&#39;</span><span class="p">)</span>

<span class="c1"># Compute the error</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_r</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_r</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Rel. error %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_r</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_r</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.008</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>

<span class="c1"># Imaginary, log-lin</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">322</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(b) log-lin Imag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interpolated&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Imaginary, log-symlog</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">324</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(d) log-symlog Imag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthreshy</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="c1"># Imaginary, error</span>
<span class="n">ax6</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">326</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(f) clipped 0.01-10&#39;</span><span class="p">)</span>

<span class="c1"># Compute error</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_i</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_i</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_i</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_i</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.008</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="(a) log-lin Real, (c) log-symlog Real, (e) clipped 0.01-10, (b) log-lin Imag, (d) log-symlog Imag, (f) clipped 0.01-10" class="sphx-glr-single-img" src="../../_images/sphx_glr_fullspace_001.png" />
</div>
<div class="section" id="fourier-transform">
<h3>Fourier Transform<a class="headerlink" href="#fourier-transform" title="Permalink to this headline">¶</a></h3>
<p>Carry-out Fourier transform, compute analytical result</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute corresponding time-domain signal.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq2time</span></a></a></a></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Analytical result</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">ft</span><span class="o">=</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ft" title="emg3d.utils.Fourier.ft" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ft" title="emg3d.utils.Fourier.ft" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ft" title="emg3d.utils.Fourier.ft" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ft" title="emg3d.utils.Fourier.ft" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">ft</span></a></a></a></a><span class="p">,</span> <span class="n">ftarg</span><span class="o">=</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ftarg" title="emg3d.utils.Fourier.ftarg" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ftarg" title="emg3d.utils.Fourier.ftarg" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ftarg" title="emg3d.utils.Fourier.ftarg" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ftarg" title="emg3d.utils.Fourier.ftarg" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">ftarg</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-time-domain-result">
<h3>Plot time-domain result<a class="headerlink" href="#plot-time-domain-result" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># lin-lin</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(a) lin-lin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_x$ (nV/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>

<span class="c1"># log-log</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(b) log-log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;empymod, analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;empymod, same FT as emg3d&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;emg3d, FFTLog&#39;</span><span class="p">)</span>
<span class="n">perr</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time</span></a></a></a></a><span class="p">)</span><span class="o">-</span><span class="nb">max</span><span class="p">(</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">))</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;k&gt;&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Peak error: </span><span class="si">{</span><span class="n">perr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">1.5e-2</span><span class="p">,</span> <span class="mf">2e0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Error</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(c) clipped 0.01-10 %&#39;</span><span class="p">)</span>

<span class="c1"># Compute error</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">)</span><span class="o">/</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err2</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">)</span><span class="o">/</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err2</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Rel. error %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.008</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Plot peak error</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="(a) lin-lin, (b) log-log, (c) clipped 0.01-10 %" class="sphx-glr-single-img" src="../../_images/sphx_glr_fullspace_002.png" />
</div>
<div class="section" id="further-explanations-to-the-results-in-the-above-figure">
<h3>Further explanations to the results in the above figure:<a class="headerlink" href="#further-explanations-to-the-results-in-the-above-figure" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The black line is the analytical fullspace solution in the time-domain.</p></li>
<li><p>The blue result was obtained with empymod, using the same Fourier-transform
parameters as used for <code class="docutils literal notranslate"><span class="pre">emg3d</span></code>, hence FFTLog with 5 pts per decade.
However, in contrary to the red response, all frequencies are computed,
with a very high precision.</p></li>
<li><p>The red result is the result obtain with <code class="docutils literal notranslate"><span class="pre">emg3d</span></code>.</p></li>
</ul>
</div>
</div>
<div class="section" id="using-dlf">
<h2>2. Using DLF<a class="headerlink" href="#using-dlf" title="Permalink to this headline">¶</a></h2>
<p>We use the same frequencies and computed data as in the FFTLog example, but
apply the digital-linear-filter method for the transformation.</p>
<div class="section" id="fourier-transform-parameters-for-dlf">
<h3>Fourier Transform parameters for DLF<a class="headerlink" href="#fourier-transform-parameters-for-dlf" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Fourier_dlf</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Fourier</span></a></a></a></a><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span>
    <span class="n">fmin</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">fmax</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span>
    <span class="n">ft</span><span class="o">=</span><span class="s1">&#39;dlf&#39;</span><span class="p">,</span>  <span class="c1"># Fourier transform to use</span>
    <span class="n">ftarg</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pts_per_dec&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">},</span>
    <span class="n">freq_inp</span><span class="o">=</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span>  <span class="c1"># Use same frequencies as in above example</span>
<span class="p">)</span>


<span class="c1"># Dense frequencies for comparison reasons</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense_dlf</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">logspace</span></a></a></a></a><span class="p">(</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_req</span><span class="o">.</span><span class="n">min</span></a></a></a></a><span class="p">()),</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_req</span><span class="o">.</span><span class="n">max</span></a></a></a></a><span class="p">()),</span>
        <span class="mi">301</span><span class="p">)</span>

<span class="c1"># Get data</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int_dlf</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">interpolate</span></a></a></a></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">)</span>

<span class="c1"># Compute analytical result using empymod (epm)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req_dlf</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc_dlf</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense_dlf</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense_dlf</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>time        [s] :  0.01 - 10 : 201  [min-max; #]
Fourier         :  DLF (Sine-Filter)
  &gt; Filter      :  Key 201 CosSin (2012)
  &gt; DLF type    :  Lagged Convolution
Req. freq  [Hz] :  1.4626E-08 - 1.80659E+07 : 251  [min-max; #]
Calc. freq [Hz] :  0.0503292 - 20.0364 : 14  [min-max; #]
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Interpolate missing frequencies and compute analytical result<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int_dlf</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">interpolate</span></a></a></a></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">)</span>

<span class="c1"># Compute analytical result using empymod (epm)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req_dlf</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc_dlf</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense_dlf</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense_dlf</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3>Plot frequency-domain result<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Real, log-lin</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">321</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(a) log-lin Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense_dlf</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense_dlf</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int_dlf</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interpolated&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_x$ (nV/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Real, log-symlog</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">323</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(c) log-symlog Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense_dlf</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense_dlf</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int_dlf</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_x$ (nV/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthreshy</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="c1"># Real, error</span>
<span class="n">ax5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">325</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(e) clipped 0.01-10&#39;</span><span class="p">)</span>

<span class="c1"># Compute the error</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_r</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int_dlf</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req_dlf</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req_dlf</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_r</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc_dlf</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc_dlf</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Rel. error %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_r</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_r</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.008</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>

<span class="c1"># Imaginary, log-lin</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">322</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(b) log-lin Imag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense_dlf</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense_dlf</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int_dlf</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interpolated&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Imaginary, log-symlog</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">324</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(d) log-symlog Imag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense_dlf</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense_dlf</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int_dlf</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthreshy</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="c1"># Imaginary, error</span>
<span class="n">ax6</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">326</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(f) clipped 0.01-10&#39;</span><span class="p">)</span>

<span class="c1"># Compute error</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_i</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int_dlf</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req_dlf</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req_dlf</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_i</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc_dlf</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc_dlf</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_i</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_i</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.008</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="(a) log-lin Real, (c) log-symlog Real, (e) clipped 0.01-10, (b) log-lin Imag, (d) log-symlog Imag, (f) clipped 0.01-10" class="sphx-glr-single-img" src="../../_images/sphx_glr_fullspace_003.png" />
</div>
<div class="section" id="id4">
<h3>Fourier Transform<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Carry-out Fourier transform.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute corresponding time-domain signal.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time_dlf</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><span class="n">Fourier_dlf</span><span class="o">.</span><span class="n">freq2time</span></a></a></a></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>Plot time-domain result<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># lin-lin</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(a) lin-lin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time_dlf</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_x$ (nV/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>

<span class="c1"># log-log</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(b) log-log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;empymod, analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;empymod, same FT as emg3d&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time_dlf</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;emg3d, DLF&#39;</span><span class="p">)</span>
<span class="n">perr</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time_dlf</span></a></a></a></a><span class="p">)</span><span class="o">-</span><span class="nb">max</span><span class="p">(</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">))</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;k&gt;&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Peak error: </span><span class="si">{</span><span class="n">perr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">1.5e-2</span><span class="p">,</span> <span class="mf">2e0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Error</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(c) clipped 0.01-10 %&#39;</span><span class="p">)</span>

<span class="c1"># Compute error</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time_dlf</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">)</span><span class="o">/</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">),</span>
              <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err2</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">)</span><span class="o">/</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">),</span>
               <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err2</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Rel. error %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.008</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Plot peak error</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="(a) lin-lin, (b) log-log, (c) clipped 0.01-10 %" class="sphx-glr-single-img" src="../../_images/sphx_glr_fullspace_004.png" />
</div>
</div>
<div class="section" id="results-from-mulder-et-al-2008-geophysics">
<h2>3. Results from Mulder et al., 2008, Geophysics<a class="headerlink" href="#results-from-mulder-et-al-2008-geophysics" title="Permalink to this headline">¶</a></h2>
<p>Total computation time (CPU) is 13,632 s, which corresponds to
3 h 47 min 12 s.</p>
<div class="figure align-center" id="muld08-fig3-4">
<a class="reference internal image-reference" href="../../_images/Mulder2008_Figs_3-4_Tab_1.png"><img alt="Results Mulder et al., 2008." src="../../_images/Mulder2008_Figs_3-4_Tab_1.png" style="width: 580.8000000000001px; height: 535.26px;" /></a>
<p class="caption"><span class="caption-text">Figures 3 and 4 and Table 1, page F5 of Mulder et al., 2008, Geophysics.</span><a class="headerlink" href="#muld08-fig3-4" title="Permalink to this image">¶</a></p>
</div>
<p>The published example took roughly <strong>3.75 hours</strong>, whereas here we need just
a <strong>few minutes</strong>. There are two main reasons for the speed gain:</p>
<ol class="arabic simple">
<li><p>gridding and</p></li>
<li><p>frequency selection.</p></li>
</ol>
<p>Note re first point, gridding: We implemented here an adaptive gridding with
various number of cells. Our computation uses meshes between 36,864
(64x24x24) and 102,400 (64x40x40) cells, whereas Mulder et al., 2008, used
2,097,152 (128x128x128) for all frequencies.</p>
<p>Note re second point, frequency selection: We only used 14 frequencies from
0.05-20 Hz, whereas Mulder et al., 2008, used 26 frequencies from 0.01-100
Hz. Have a look at the example
<a class="reference internal" href="freqselect.html#sphx-glr-gallery-time-domain-freqselect-py"><span class="std std-ref">3. Interactive frequency selection</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Report.html#emg3d.utils.Report" title="emg3d.utils.Report" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Report.html#emg3d.utils.Report" title="emg3d.utils.Report" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Report.html#emg3d.utils.Report" title="emg3d.utils.Report" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Report.html#emg3d.utils.Report" title="emg3d.utils.Report" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Report</span></a></a></a></a><span class="p">()</span>
</pre></div>
</div>
<table style='border: 3px solid #ddd;'>
  <tr>
     <td style='text-align: center; font-weight: bold; font-size: 1.2em; border: 2px solid #fff;' colspan='6'>Wed Jul 29 22:46:02 2020 CEST</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>OS</td>
    <td style='text-align: left; border: 2px solid #fff;'>Linux</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>CPU(s)</td>
    <td style='text-align: left; border: 2px solid #fff;'>4</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Machine</td>
    <td style='text-align: left; border: 2px solid #fff;'>x86_64</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Architecture</td>
    <td style='text-align: left; border: 2px solid #fff;'>64bit</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>RAM</td>
    <td style='text-align: left; border: 2px solid #fff;'>15.5 GB</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Environment</td>
    <td style='text-align: left; border: 2px solid #fff;'>Python</td>
  </tr>
  <tr>
     <td style='text-align: center; border: 2px solid #fff;' colspan='6'>Python 3.8.3 (default, Jul  2 2020, 16:21:59)
[GCC 7.3.0]</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>numpy</td>
    <td style='text-align: left; border: 2px solid #fff;'>1.18.5</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>scipy</td>
    <td style='text-align: left; border: 2px solid #fff;'>1.5.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>numba</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.50.1</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>emg3d</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.12.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>empymod</td>
    <td style='text-align: left; border: 2px solid #fff;'>2.0.2</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>xarray</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.16.0</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>discretize</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.4.15</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>h5py</td>
    <td style='text-align: left; border: 2px solid #fff;'>2.10.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>matplotlib</td>
    <td style='text-align: left; border: 2px solid #fff;'>3.2.2</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>IPython</td>
    <td style='text-align: left; border: 2px solid #fff;'>7.16.1</td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
  </tr>
  <tr>
     <td style='text-align: center; background-color: #ddd;border: 2px solid #fff;' colspan='6'>Intel(R) Math Kernel Library Version 2020.0.1 Product Build 20200208 for Intel(R) 64 architecture applications</td>
  </tr>
</table>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  53.766 seconds)</p>
<p><strong>Estimated memory usage:</strong>  9 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-time-domain-fullspace-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/f03bb8fca82cb491628ae89f2f8d2bb6/fullspace.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">fullspace.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8e9c2c6060a24c33d616d81e296b9297/fullspace.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">fullspace.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="marine_1D.html" class="btn btn-neutral float-right" title="2. Transient CSEM for a marine model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../magnetics/magnetic_permeability.html" class="btn btn-neutral float-left" title="4. Magnetic permeability" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2020, The emg3d Developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>