

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2. Transient CSEM for a marine model &mdash; emg3d-gallery 0.12.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3. Interactive frequency selection" href="freqselect.html" />
    <link rel="prev" title="1. Transient CSEM for a homogeneous space" href="fullspace.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo-emg3d-cut.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.12.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Example Gallery</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#examples-and-tutorials">Examples and Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#comparisons">Comparisons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#magnetic-fields-and-magnetic-permeability">Magnetic fields and magnetic permeability</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#time-domain">Time Domain</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="fullspace.html">1. Transient CSEM for a homogeneous space</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2. Transient CSEM for a marine model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#model-and-survey">Model and Survey</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fourier-transform-parameters">Fourier Transform parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#frequency-domain-computation">Frequency-domain computation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fourier-transform">Fourier Transform</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="freqselect.html">3. Interactive frequency selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tools">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#reproducing">Reproducing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#interactions">Interactions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../manual.html">Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">Links</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://empymod.github.io"><i class="fa fa-link fa-fw"></i> Website</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/empymod/emg3d-gallery"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">emg3d-gallery</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Gallery</a> &raquo;</li>
        
      <li>2. Transient CSEM for a marine model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/gallery/time_domain/marine_1D.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="freqselect.html" class="btn btn-neutral float-right" title="3. Interactive frequency selection" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fullspace.html" class="btn btn-neutral float-left" title="1. Transient CSEM for a homogeneous space" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gallery-time-domain-marine-1d-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="transient-csem-for-a-marine-model">
<span id="sphx-glr-gallery-time-domain-marine-1d-py"></span><h1>2. Transient CSEM for a marine model<a class="headerlink" href="#transient-csem-for-a-marine-model" title="Permalink to this headline">¶</a></h1>
<p>Example how to use <code class="docutils literal notranslate"><span class="pre">emg3d</span></code> to model time-domain data using FFTLog.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">emg3d</span>
<span class="kn">import</span> <span class="nn">empymod</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clim</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a></a></a></a><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>

<span class="c1"># Name is used to store the data for each frequency.</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Marine-1D&#39;</span>
</pre></div>
</div>
<div class="section" id="model-and-survey">
<h2>Model and Survey<a class="headerlink" href="#model-and-survey" title="Permalink to this headline">¶</a></h2>
<div class="section" id="model">
<h3>Model<a class="headerlink" href="#model" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>1 km water depth, 0.3 Ohm.m.</p></li>
<li><p>Target of 100 Ohm.m, 500 m thick, 1 km below seafloor.</p></li>
<li><p>Air set to 1e8 Ohm.m, background is 1 Ohm.m.</p></li>
</ul>
</div>
<div class="section" id="survey">
<h3>Survey<a class="headerlink" href="#survey" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Source at origin, 50 m above seafloor.</p></li>
<li><p>Receiver on the seafloor at an inline-offset of 4 km.</p></li>
<li><p>Both source and receiver are x-directed electric dipoles.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">950</span><span class="p">]</span>
<span class="n">rec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a></a></a></a><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">])</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">depth</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a></a></a></a><span class="p">([</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Here we create a dummy mesh with one cell in x- and y-directions, and our 1D
model in z-direction. From this, we can interpolate the model to our varying
meshes afterwards.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the mesh.</span>
<a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_mesh</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">TensorMesh</span></a></a></a></a><span class="p">(</span>
    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a></a></a></a><span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.diff.html#numpy.diff" title="numpy.diff" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.diff.html#numpy.diff" title="numpy.diff" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.diff.html#numpy.diff" title="numpy.diff" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.diff.html#numpy.diff" title="numpy.diff" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">diff</span></a></a></a></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">depth</span></a></a></a></a><span class="p">),</span> <span class="mi">1000</span><span class="p">]],</span>
    <span class="n">x0</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">depth</span></a></a></a></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1000</span><span class="p">))</span>

<span class="c1"># Create a resistivity model using the 1D model and the above mesh.</span>
<a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_model</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Model</span></a></a></a></a><span class="p">(</span>
        <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_mesh</span></a></a></a></a><span class="p">,</span> <span class="n">property_x</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a></a></a></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res</span></a></a></a></a><span class="p">),</span> <span class="n">mapping</span><span class="o">=</span><span class="s1">&#39;Resistivity&#39;</span><span class="p">)</span>

<span class="c1"># QC.</span>
<a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.plot_3d_slicer" title="discretize.TensorMesh.plot_3d_slicer" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.plot_3d_slicer" title="discretize.TensorMesh.plot_3d_slicer" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.plot_3d_slicer" title="discretize.TensorMesh.plot_3d_slicer" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.plot_3d_slicer" title="discretize.TensorMesh.plot_3d_slicer" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">orig_mesh</span><span class="o">.</span><span class="n">plot_3d_slicer</span></a></a></a></a><span class="p">(</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model.property_x" title="emg3d.models.Model.property_x" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model.property_x" title="emg3d.models.Model.property_x" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model.property_x" title="emg3d.models.Model.property_x" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model.property_x" title="emg3d.models.Model.property_x" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-attribute"><span class="n">orig_model</span><span class="o">.</span><span class="n">property_x</span></a></a></a></a><span class="p">),</span> <span class="n">zlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clim</span></a></a></a></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clim</span></a></a></a></a><span class="p">)</span>

<span class="c1"># Get figure and axes</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Resistivity model&#39;</span><span class="p">)</span>

<span class="c1"># Adjust the y-labels on the first subplot (XY)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y-direction (m)&#39;</span><span class="p">)</span>

<span class="c1"># Adjust x- and y-labels on the second subplot (XZ)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Easting (m)&#39;</span><span class="p">)</span>

<span class="c1"># plt.setp(axs[2].yaxis.get_majorticklabels(), rotation=90)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="o">-</span><span class="mi">2500</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;$0.0$&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.5&#39;</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Elevation (km)&#39;</span><span class="p">)</span>

<span class="c1"># Adjust x-labels on the third subplot (ZY)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">400</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="o">-</span><span class="mi">3000</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.0$&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.5&#39;</span><span class="p">])</span>

<span class="c1"># Adjust colorbar</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rm</span><span class="si">{log}</span><span class="s1">_</span><span class="si">{10}</span><span class="s1">-$resistivity ($\Omega\,$m)&#39;</span><span class="p">)</span>

<span class="c1"># Ensure sufficient margins so nothing is clipped</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Resistivity model" class="sphx-glr-single-img" src="../../_images/sphx_glr_marine_1D_001.png" />
</div>
</div>
<div class="section" id="fourier-transform-parameters">
<h2>Fourier Transform parameters<a class="headerlink" href="#fourier-transform-parameters" title="Permalink to this headline">¶</a></h2>
<p>We only compute frequencies <span class="math notranslate nohighlight">\(0.003 &lt; f &lt; 5\)</span> Hz, which yields enough
precision for our purpose.</p>
<p>This means, instead of 30 frequencies from 0.00002 - 12.6 Hz, we only need 16
frequencies from 0.003 - 3.2 Hz.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define desired times.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">logspace</span></a></a></a></a><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>

<span class="c1"># Initiate a Fourier instance</span>
<a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Fourier</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier" title="emg3d.utils.Fourier" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Fourier</span></a></a></a></a><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span>
    <span class="n">fmin</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span>
    <span class="n">fmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">ft</span><span class="o">=</span><span class="s1">&#39;fftlog&#39;</span><span class="p">,</span>  <span class="c1"># Fourier transform to use</span>
    <span class="n">ftarg</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pts_per_dec&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;add_dec&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
<span class="p">)</span>

<span class="c1"># Dense frequencies for comparison reasons</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">logspace</span></a></a></a></a><span class="p">(</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span><span class="o">.</span><span class="n">min</span></a></a></a></a><span class="p">()),</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span><span class="o">.</span><span class="n">max</span></a></a></a></a><span class="p">()),</span>
        <span class="mi">301</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>time        [s] :  0.1 - 100 : 201  [min-max; #]
Fourier         :  FFTLog
  &gt; pts_per_dec :  5
  &gt; add_dec     :  [-2.  1.]
  &gt; q           :  0.0
Req. freq  [Hz] :  2.00364E-05 - 12.6421 : 30  [min-max; #]
Calc. freq [Hz] :  0.00317556 - 3.17556 : 16  [min-max; #]
</pre></div>
</div>
</div>
<div class="section" id="frequency-domain-computation">
<h2>Frequency-domain computation<a class="headerlink" href="#frequency-domain-computation" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># To store the info of each frequency.</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">gridinput</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min_width&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>    <span class="c1"># Fix cell width within the survey domain to 100 m.</span>
    <span class="s1">&#39;return_info&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># To get back some information for later.</span>
    <span class="s1">&#39;max_domain&#39;</span><span class="p">:</span> <span class="mi">50000</span><span class="p">,</span>
    <span class="s1">&#39;verb&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Start the timer.</span>
<span class="n">runtime</span> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Time.html#emg3d.utils.Time" title="emg3d.utils.Time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Time.html#emg3d.utils.Time" title="emg3d.utils.Time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Time.html#emg3d.utils.Time" title="emg3d.utils.Time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Time.html#emg3d.utils.Time" title="emg3d.utils.Time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">Time</span></a></a></a></a><span class="p">()</span>

<span class="c1"># Loop over frequencies, going from high to low.</span>
<span class="k">for</span> <span class="n">fi</span><span class="p">,</span> <span class="n">frq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">fi</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">2</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span><span class="o">.</span><span class="n">size</span></a></a></a></a><span class="si">}</span><span class="s2"> :: </span><span class="si">{</span><span class="n">frq</span><span class="si">:</span><span class="s2">10.6f</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>

    <span class="c1"># Key is used to store the data etc.</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">frq</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span>

    <span class="c1"># Initiate log for this frequency.</span>
    <span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frq</span>

    <span class="c1"># Get cell widths and origin in each direction</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">xx</span></a></a></a></a><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">hix</span> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><span class="n">emg3d</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">get_hx_h0</span></a></a></a></a><span class="p">(</span>
        <span class="n">freq</span><span class="o">=</span><span class="n">frq</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res</span></a></a></a></a><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">],</span> <span class="n">fixed</span><span class="o">=</span><span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">7100</span><span class="p">],</span>
        <span class="o">**</span><span class="n">gridinput</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">yy</span></a></a></a></a><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">hiy</span> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><span class="n">emg3d</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">get_hx_h0</span></a></a></a></a><span class="p">(</span>
        <span class="n">freq</span><span class="o">=</span><span class="n">frq</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res</span></a></a></a></a><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">],</span> <span class="n">fixed</span><span class="o">=</span><span class="n">src</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">],</span> <span class="o">**</span><span class="n">gridinput</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">zz</span></a></a></a></a><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">hiz</span> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.get_hx_h0.html#emg3d.meshes.get_hx_h0" title="emg3d.meshes.get_hx_h0" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-function"><span class="n">emg3d</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">get_hx_h0</span></a></a></a></a><span class="p">(</span>
        <span class="n">freq</span><span class="o">=</span><span class="n">frq</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res</span></a></a></a></a><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">],</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2300</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">gridinput</span><span class="p">,</span>
        <span class="n">fixed</span><span class="o">=</span><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">depth</span></a></a></a></a><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">depth</span></a></a></a></a><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">depth</span></a></a></a></a><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

    <span class="c1"># Store values in log.</span>
    <span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">hix</span><span class="p">[</span><span class="s1">&#39;amin&#39;</span><span class="p">],</span> <span class="n">hiy</span><span class="p">[</span><span class="s1">&#39;amin&#39;</span><span class="p">],</span> <span class="n">hiz</span><span class="p">[</span><span class="s1">&#39;amin&#39;</span><span class="p">]]),</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">hix</span><span class="p">[</span><span class="s1">&#39;amax&#39;</span><span class="p">],</span> <span class="n">hiy</span><span class="p">[</span><span class="s1">&#39;amax&#39;</span><span class="p">],</span> <span class="n">hiz</span><span class="p">[</span><span class="s1">&#39;amax&#39;</span><span class="p">]])]</span>
    <span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;dminmax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">hix</span><span class="p">[</span><span class="s1">&#39;dmin&#39;</span><span class="p">],</span> <span class="n">hiy</span><span class="p">[</span><span class="s1">&#39;dmin&#39;</span><span class="p">],</span> <span class="n">hiz</span><span class="p">[</span><span class="s1">&#39;dmin&#39;</span><span class="p">]]),</span>
                              <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">hix</span><span class="p">[</span><span class="s1">&#39;dmax&#39;</span><span class="p">],</span> <span class="n">hiy</span><span class="p">[</span><span class="s1">&#39;dmax&#39;</span><span class="p">],</span> <span class="n">hiz</span><span class="p">[</span><span class="s1">&#39;dmax&#39;</span><span class="p">]])]</span>

    <span class="c1"># Initiate mesh.</span>
    <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">TensorMesh</span></a></a></a></a><span class="p">([</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">xx</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">yy</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">zz</span></a></a></a></a><span class="p">],</span> <span class="n">x0</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a></a></a></a><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span><span class="p">]))</span>
    <span class="c1"># print(grid)</span>
    <span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;nC&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nC" title="discretize.TensorMesh.nC" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nC" title="discretize.TensorMesh.nC" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nC" title="discretize.TensorMesh.nC" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><a href="https://discretize.simpeg.xyz/en/master/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nC" title="discretize.TensorMesh.nC" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid</span><span class="o">.</span><span class="n">nC</span></a></a></a></a>  <span class="c1"># Store number of cells in log.</span>

    <span class="c1"># Generate model (interpolate on log-scale from our coarse model).</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_x</span></a></a></a></a> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.maps.grid2grid.html#emg3d.maps.grid2grid" title="emg3d.maps.grid2grid" class="sphx-glr-backref-module-emg3d-maps sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.maps.grid2grid.html#emg3d.maps.grid2grid" title="emg3d.maps.grid2grid" class="sphx-glr-backref-module-emg3d-maps sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.maps.grid2grid.html#emg3d.maps.grid2grid" title="emg3d.maps.grid2grid" class="sphx-glr-backref-module-emg3d-maps sphx-glr-backref-type-py-function"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.maps.grid2grid.html#emg3d.maps.grid2grid" title="emg3d.maps.grid2grid" class="sphx-glr-backref-module-emg3d-maps sphx-glr-backref-type-py-function"><span class="n">emg3d</span><span class="o">.</span><span class="n">maps</span><span class="o">.</span><span class="n">grid2grid</span></a></a></a></a><span class="p">(</span>
            <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_mesh</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><a href="https://numpy.org/doc/stable/reference/generated/numpy.log10.html#numpy.log10" title="numpy.log10" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model.property_x" title="emg3d.models.Model.property_x" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model.property_x" title="emg3d.models.Model.property_x" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model.property_x" title="emg3d.models.Model.property_x" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model.property_x" title="emg3d.models.Model.property_x" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-attribute"><span class="n">orig_model</span><span class="o">.</span><span class="n">property_x</span></a></a></a></a><span class="p">),</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">)</span>
    <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Model</span></a></a></a></a><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span> <span class="n">property_x</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_x</span></a></a></a></a><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="s1">&#39;Resistivity&#39;</span><span class="p">)</span>

    <span class="c1"># QC</span>
    <span class="c1"># grid.plot_3d_slicer(np.log10(model.property_x),</span>
    <span class="c1">#                     zlim=[-3000, 500], clim=clim)</span>

    <span class="c1"># Define source.</span>
    <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfield</span></a></a></a></a> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">get_source_field</span><span class="p">(</span>
        <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span> <span class="p">[</span><span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">src</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">src</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">frq</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Solve the system.</span>
    <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">efield</span></a></a></a></a><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span>
        <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.SourceField.html#emg3d.fields.SourceField" title="emg3d.fields.SourceField" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfield</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">sslsolver</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">semicoarsening</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linerelaxation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Store info</span>
    <span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>

    <span class="c1"># Store value</span>
    <span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">get_receiver</span><span class="p">(</span>
            <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><span class="n">efield</span><span class="o">.</span><span class="n">fx</span></a></a></a></a><span class="p">,</span> <span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

<span class="c1"># Stop the timer.</span>
<span class="n">total_time</span> <span class="o">=</span> <span class="n">runtime</span><span class="o">.</span><span class="n">runtime</span>

<span class="c1"># Store data and info to disk</span>
<span class="n">emg3d</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.npz&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>   1/16 ::   3.175559 Hz
:: emg3d :: 2.5e-03; 0(1); 0:00:02
:: emg3d :: 5.2e-05; 0(2); 0:00:05
:: emg3d :: 8.8e-06; 0(3); 0:00:07
:: emg3d :: 2.2e-06; 0(4); 0:00:09
:: emg3d :: 2.4e-07; 0(5); 0:00:11
:: emg3d :: 2.4e-07; 1(5); 0:00:11
:: emg3d :: 2.4e-07; 1(5); 0:00:11; CONVERGED
   2/16 ::   2.003642 Hz
:: emg3d :: 3.8e-03; 0(1); 0:00:03
:: emg3d :: 8.5e-05; 0(2); 0:00:05
:: emg3d :: 2.5e-05; 0(3); 0:00:08
:: emg3d :: 6.5e-06; 0(4); 0:00:11
:: emg3d :: 4.0e-07; 0(5); 0:00:14
:: emg3d :: 3.9e-07; 1(5); 0:00:14
:: emg3d :: 3.9e-07; 1(5); 0:00:14; CONVERGED
   3/16 ::   1.264213 Hz
:: emg3d :: 4.7e-03; 0(1); 0:00:03
:: emg3d :: 1.2e-04; 0(2); 0:00:05
:: emg3d :: 7.9e-05; 0(3); 0:00:08
:: emg3d :: 1.9e-05; 0(4); 0:00:11
:: emg3d :: 1.3e-06; 0(5); 0:00:14
:: emg3d :: 1.2e-06; 0(6); 0:00:16
:: emg3d :: 9.6e-07; 1(6); 0:00:16
:: emg3d :: 9.6e-07; 1(6); 0:00:16; CONVERGED
   4/16 ::   0.797664 Hz
:: emg3d :: 5.9e-03; 0(1); 0:00:03
:: emg3d :: 2.4e-04; 0(2); 0:00:05
:: emg3d :: 2.2e-04; 0(3); 0:00:08
:: emg3d :: 5.0e-05; 0(4); 0:00:11
:: emg3d :: 3.4e-06; 0(5); 0:00:14
:: emg3d :: 3.1e-06; 0(6); 0:00:16
:: emg3d :: 2.9e-06; 1(6); 0:00:16
:: emg3d :: 1.3e-06; 1(7); 0:00:19
:: emg3d :: 8.6e-08; 1(8); 0:00:22
:: emg3d :: 7.6e-08; 2(8); 0:00:22
:: emg3d :: 7.6e-08; 2(8); 0:00:22; CONVERGED
   5/16 ::   0.503292 Hz
:: emg3d :: 6.7e-03; 0(1); 0:00:03
:: emg3d :: 3.8e-04; 0(2); 0:00:05
:: emg3d :: 4.9e-04; 0(3); 0:00:08
:: emg3d :: 1.2e-04; 0(4); 0:00:11
:: emg3d :: 1.1e-05; 0(5); 0:00:14
:: emg3d :: 1.7e-05; 0(6); 0:00:16
:: emg3d :: 1.3e-05; 1(6); 0:00:16
:: emg3d :: 4.4e-06; 1(7); 0:00:19
:: emg3d :: 4.3e-07; 1(8); 0:00:22
:: emg3d :: 4.3e-07; 2(8); 0:00:22
:: emg3d :: 4.3e-07; 2(8); 0:00:22; CONVERGED
   6/16 ::   0.317556 Hz
:: emg3d :: 7.7e-03; 0(1); 0:00:03
:: emg3d :: 4.3e-04; 0(2); 0:00:05
:: emg3d :: 6.3e-04; 0(3); 0:00:08
:: emg3d :: 1.9e-04; 0(4); 0:00:11
:: emg3d :: 1.8e-05; 0(5); 0:00:14
:: emg3d :: 4.0e-05; 0(6); 0:00:16
:: emg3d :: 1.9e-05; 1(6); 0:00:16
:: emg3d :: 2.6e-06; 1(7); 0:00:19
:: emg3d :: 2.9e-07; 1(8); 0:00:22
:: emg3d :: 5.7e-07; 1(9); 0:00:24
:: emg3d :: 4.1e-07; 2(9); 0:00:25
:: emg3d :: 4.1e-07; 2(9); 0:00:25; CONVERGED
   7/16 ::   0.200364 Hz
:: emg3d :: 9.3e-03; 0(1); 0:00:03
:: emg3d :: 7.6e-04; 0(2); 0:00:05
:: emg3d :: 1.1e-03; 0(3); 0:00:08
:: emg3d :: 3.2e-04; 0(4); 0:00:11
:: emg3d :: 3.9e-05; 0(5); 0:00:14
:: emg3d :: 9.9e-05; 0(6); 0:00:16
:: emg3d :: 4.6e-05; 1(6); 0:00:16
:: emg3d :: 6.2e-06; 1(7); 0:00:19
:: emg3d :: 8.2e-07; 1(8); 0:00:22
:: emg3d :: 2.4e-06; 1(9); 0:00:25
:: emg3d :: 2.7e-07; 1(10); 0:00:27
:: emg3d :: 2.7e-07; 2(10); 0:00:27
:: emg3d :: 2.7e-07; 2(10); 0:00:27; CONVERGED
   8/16 ::   0.126421 Hz
:: emg3d :: 1.1e-02; 0(1); 0:00:03
:: emg3d :: 1.3e-03; 0(2); 0:00:05
:: emg3d :: 1.7e-03; 0(3); 0:00:08
:: emg3d :: 4.7e-04; 0(4); 0:00:11
:: emg3d :: 8.5e-05; 0(5); 0:00:14
:: emg3d :: 2.2e-04; 0(6); 0:00:16
:: emg3d :: 1.4e-04; 1(6); 0:00:16
:: emg3d :: 3.4e-05; 1(7); 0:00:19
:: emg3d :: 6.0e-06; 1(8); 0:00:22
:: emg3d :: 1.0e-05; 1(9); 0:00:24
:: emg3d :: 1.6e-06; 1(10); 0:00:27
:: emg3d :: 2.3e-07; 1(11); 0:00:30
:: emg3d :: 2.3e-07; 2(11); 0:00:30
:: emg3d :: 2.3e-07; 2(11); 0:00:30; CONVERGED
   9/16 ::   0.079766 Hz
:: emg3d :: 1.4e-02; 0(1); 0:00:03
:: emg3d :: 2.1e-03; 0(2); 0:00:05
:: emg3d :: 2.4e-03; 0(3); 0:00:08
:: emg3d :: 6.5e-04; 0(4); 0:00:11
:: emg3d :: 1.5e-04; 0(5); 0:00:14
:: emg3d :: 4.0e-04; 0(6); 0:00:16
:: emg3d :: 2.8e-04; 1(6); 0:00:16
:: emg3d :: 5.9e-05; 1(7); 0:00:19
:: emg3d :: 1.2e-05; 1(8); 0:00:22
:: emg3d :: 2.3e-05; 1(9); 0:00:24
:: emg3d :: 4.2e-06; 1(10); 0:00:27
:: emg3d :: 7.4e-07; 1(11); 0:00:30
:: emg3d :: 7.4e-07; 2(11); 0:00:30
:: emg3d :: 7.4e-07; 2(11); 0:00:30; CONVERGED
  10/16 ::   0.050329 Hz
:: emg3d :: 1.8e-02; 0(1); 0:00:03
:: emg3d :: 3.1e-03; 0(2); 0:00:05
:: emg3d :: 3.9e-03; 0(3); 0:00:08
:: emg3d :: 9.9e-04; 0(4); 0:00:11
:: emg3d :: 2.6e-04; 0(5); 0:00:14
:: emg3d :: 8.2e-04; 0(6); 0:00:16
:: emg3d :: 5.9e-04; 1(6); 0:00:16
:: emg3d :: 1.1e-04; 1(7); 0:00:19
:: emg3d :: 2.3e-05; 1(8); 0:00:22
:: emg3d :: 6.1e-05; 1(9); 0:00:24
:: emg3d :: 9.2e-06; 1(10); 0:00:27
:: emg3d :: 2.1e-06; 1(11); 0:00:30
:: emg3d :: 4.0e-06; 1(12); 0:00:32
:: emg3d :: 3.7e-06; 2(12); 0:00:33
:: emg3d :: 9.6e-07; 2(13); 0:00:35
:: emg3d :: 9.7e-07; 3(13); 0:00:35
:: emg3d :: 9.7e-07; 3(13); 0:00:35; CONVERGED
  11/16 ::   0.031756 Hz
:: emg3d :: 2.4e-02; 0(1); 0:00:03
:: emg3d :: 4.4e-03; 0(2); 0:00:05
:: emg3d :: 5.6e-03; 0(3); 0:00:08
:: emg3d :: 1.6e-03; 0(4); 0:00:11
:: emg3d :: 5.0e-04; 0(5); 0:00:14
:: emg3d :: 1.5e-03; 0(6); 0:00:16
:: emg3d :: 1.1e-03; 1(6); 0:00:16
:: emg3d :: 2.1e-04; 1(7); 0:00:19
:: emg3d :: 5.4e-05; 1(8); 0:00:22
:: emg3d :: 1.6e-04; 1(9); 0:00:24
:: emg3d :: 2.1e-05; 1(10); 0:00:27
:: emg3d :: 5.7e-06; 1(11); 0:00:30
:: emg3d :: 1.2e-05; 1(12); 0:00:33
:: emg3d :: 1.1e-05; 2(12); 0:00:33
:: emg3d :: 2.5e-06; 2(13); 0:00:35
:: emg3d :: 8.1e-07; 2(14); 0:00:38
:: emg3d :: 2.4e-06; 2(15); 0:00:41
:: emg3d :: 4.4e-07; 2(16); 0:00:43
:: emg3d :: 4.2e-07; 3(16); 0:00:43
:: emg3d :: 4.2e-07; 3(16); 0:00:43; CONVERGED
  12/16 ::   0.020036 Hz
:: emg3d :: 3.5e-02; 0(1); 0:00:03
:: emg3d :: 6.3e-03; 0(2); 0:00:05
:: emg3d :: 7.8e-03; 0(3); 0:00:08
:: emg3d :: 2.8e-03; 0(4); 0:00:11
:: emg3d :: 1.0e-03; 0(5); 0:00:14
:: emg3d :: 2.5e-03; 0(6); 0:00:16
:: emg3d :: 1.8e-03; 1(6); 0:00:16
:: emg3d :: 4.5e-04; 1(7); 0:00:19
:: emg3d :: 1.1e-04; 1(8); 0:00:22
:: emg3d :: 3.5e-04; 1(9); 0:00:24
:: emg3d :: 5.1e-05; 1(10); 0:00:27
:: emg3d :: 1.4e-05; 1(11); 0:00:30
:: emg3d :: 2.9e-05; 1(12); 0:00:32
:: emg3d :: 2.4e-05; 2(12); 0:00:32
:: emg3d :: 5.3e-06; 2(13); 0:00:35
:: emg3d :: 2.2e-06; 2(14); 0:00:38
:: emg3d :: 7.4e-06; 2(15); 0:00:40
:: emg3d :: 4.4e-07; 2(16); 0:00:43
:: emg3d :: 4.3e-07; 3(16); 0:00:43
:: emg3d :: 4.3e-07; 3(16); 0:00:43; CONVERGED
  13/16 ::   0.012642 Hz
:: emg3d :: 4.6e-02; 0(1); 0:00:03
:: emg3d :: 8.2e-03; 0(2); 0:00:05
:: emg3d :: 1.1e-02; 0(3); 0:00:08
:: emg3d :: 4.5e-03; 0(4); 0:00:10
:: emg3d :: 1.7e-03; 0(5); 0:00:13
:: emg3d :: 4.4e-03; 0(6); 0:00:16
:: emg3d :: 2.9e-03; 1(6); 0:00:16
:: emg3d :: 1.1e-03; 1(7); 0:00:18
:: emg3d :: 2.8e-04; 1(8); 0:00:21
:: emg3d :: 7.4e-04; 1(9); 0:00:24
:: emg3d :: 1.4e-04; 1(10); 0:00:26
:: emg3d :: 4.1e-05; 1(11); 0:00:29
:: emg3d :: 9.7e-05; 1(12); 0:00:31
:: emg3d :: 7.1e-05; 2(12); 0:00:31
:: emg3d :: 1.9e-05; 2(13); 0:00:34
:: emg3d :: 7.5e-06; 2(14); 0:00:37
:: emg3d :: 2.3e-05; 2(15); 0:00:39
:: emg3d :: 1.8e-06; 2(16); 0:00:42
:: emg3d :: 5.1e-07; 2(17); 0:00:44
:: emg3d :: 5.1e-07; 3(17); 0:00:45
:: emg3d :: 5.1e-07; 3(17); 0:00:45; CONVERGED
  14/16 ::   0.007977 Hz
:: emg3d :: 6.1e-02; 0(1); 0:00:03
:: emg3d :: 1.1e-02; 0(2); 0:00:05
:: emg3d :: 1.4e-02; 0(3); 0:00:08
:: emg3d :: 7.3e-03; 0(4); 0:00:10
:: emg3d :: 2.8e-03; 0(5); 0:00:13
:: emg3d :: 7.0e-03; 0(6); 0:00:16
:: emg3d :: 4.8e-03; 1(6); 0:00:16
:: emg3d :: 2.2e-03; 1(7); 0:00:18
:: emg3d :: 5.9e-04; 1(8); 0:00:21
:: emg3d :: 1.5e-03; 1(9); 0:00:24
:: emg3d :: 3.3e-04; 1(10); 0:00:26
:: emg3d :: 1.1e-04; 1(11); 0:00:29
:: emg3d :: 2.8e-04; 1(12); 0:00:31
:: emg3d :: 1.9e-04; 2(12); 0:00:31
:: emg3d :: 5.9e-05; 2(13); 0:00:34
:: emg3d :: 2.1e-05; 2(14); 0:00:37
:: emg3d :: 6.6e-05; 2(15); 0:00:39
:: emg3d :: 8.7e-06; 2(16); 0:00:42
:: emg3d :: 2.5e-06; 2(17); 0:00:45
:: emg3d :: 5.3e-06; 2(18); 0:00:47
:: emg3d :: 4.1e-06; 3(18); 0:00:47
:: emg3d :: 1.1e-06; 3(19); 0:00:50
:: emg3d :: 4.9e-07; 3(20); 0:00:52
:: emg3d :: 9.4e-07; 3(21); 0:00:55
:: emg3d :: 4.7e-07; 4(21); 0:00:55
:: emg3d :: 4.7e-07; 4(21); 0:00:55; CONVERGED
  15/16 ::   0.005033 Hz
:: emg3d :: 6.2e-02; 0(1); 0:00:04
:: emg3d :: 9.7e-03; 0(2); 0:00:07
:: emg3d :: 2.0e-02; 0(3); 0:00:11
:: emg3d :: 8.2e-03; 0(4); 0:00:14
:: emg3d :: 3.1e-03; 0(5); 0:00:18
:: emg3d :: 1.3e-02; 0(6); 0:00:21
:: emg3d :: 8.4e-03; 1(6); 0:00:21
:: emg3d :: 4.0e-03; 1(7); 0:00:25
:: emg3d :: 1.1e-03; 1(8); 0:00:28
:: emg3d :: 3.3e-03; 1(9); 0:00:32
:: emg3d :: 7.6e-04; 1(10); 0:00:35
:: emg3d :: 2.6e-04; 1(11); 0:00:39
:: emg3d :: 1.2e-03; 1(12); 0:00:42
:: emg3d :: 6.8e-04; 2(12); 0:00:43
:: emg3d :: 2.2e-04; 2(13); 0:00:46
:: emg3d :: 7.3e-05; 2(14); 0:00:50
:: emg3d :: 2.7e-04; 2(15); 0:00:53
:: emg3d :: 5.1e-05; 2(16); 0:00:57
:: emg3d :: 1.5e-05; 2(17); 0:01:00
:: emg3d :: 3.5e-05; 2(18); 0:01:04
:: emg3d :: 2.6e-05; 3(18); 0:01:04
:: emg3d :: 7.0e-06; 3(19); 0:01:07
:: emg3d :: 3.1e-06; 3(20); 0:01:11
:: emg3d :: 1.2e-05; 3(21); 0:01:14
:: emg3d :: 9.8e-07; 3(22); 0:01:18
:: emg3d :: 9.8e-07; 4(22); 0:01:18
:: emg3d :: 9.8e-07; 4(22); 0:01:18; CONVERGED
  16/16 ::   0.003176 Hz
:: emg3d :: 7.7e-02; 0(1); 0:00:04
:: emg3d :: 1.2e-02; 0(2); 0:00:07
:: emg3d :: 2.3e-02; 0(3); 0:00:11
:: emg3d :: 1.2e-02; 0(4); 0:00:14
:: emg3d :: 4.5e-03; 0(5); 0:00:18
:: emg3d :: 1.7e-02; 0(6); 0:00:21
:: emg3d :: 1.2e-02; 1(6); 0:00:21
:: emg3d :: 7.3e-03; 1(7); 0:00:25
:: emg3d :: 2.0e-03; 1(8); 0:00:28
:: emg3d :: 5.5e-03; 1(9); 0:00:32
:: emg3d :: 1.5e-03; 1(10); 0:00:35
:: emg3d :: 6.0e-04; 1(11); 0:00:39
:: emg3d :: 2.7e-03; 1(12); 0:00:42
:: emg3d :: 1.5e-03; 2(12); 0:00:42
:: emg3d :: 6.2e-04; 2(13); 0:00:46
:: emg3d :: 1.9e-04; 2(14); 0:00:50
:: emg3d :: 5.9e-04; 2(15); 0:00:53
:: emg3d :: 1.7e-04; 2(16); 0:00:57
:: emg3d :: 4.8e-05; 2(17); 0:01:00
:: emg3d :: 1.0e-04; 2(18); 0:01:04
:: emg3d :: 7.4e-05; 3(18); 0:01:04
:: emg3d :: 2.6e-05; 3(19); 0:01:07
:: emg3d :: 1.2e-05; 3(20); 0:01:11
:: emg3d :: 4.3e-05; 3(21); 0:01:14
:: emg3d :: 4.2e-06; 3(22); 0:01:18
:: emg3d :: 1.8e-06; 3(23); 0:01:21
:: emg3d :: 5.9e-06; 3(24); 0:01:25
:: emg3d :: 2.6e-06; 4(24); 0:01:25
:: emg3d :: 9.4e-07; 4(25); 0:01:28
:: emg3d :: 1.1e-06; 4(26); 0:01:32
:: emg3d :: 1.9e-06; 4(27); 0:01:35
:: emg3d :: 4.0e-07; 4(28); 0:01:39
:: emg3d :: 4.0e-07; 5(28); 0:01:39
:: emg3d :: 4.0e-07; 5(28); 0:01:39; CONVERGED
Data saved to «/home/dtr/Desktop/emg3d-gallery/examples/time_domain/Marine-1D.npz»
[emg3d v0.12.0 (format 0.12.0) on 2020-07-29T22:56:01.337841].
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load info and data</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.npz&#39;</span><span class="p">)[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>

<span class="n">runtime</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">7.3f</span><span class="si">}</span><span class="s2"> Hz: &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;it_mg&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">2g</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;it_ssl&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2"> it; &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">4.0f</span><span class="si">}</span><span class="s2"> s; &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;a: </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ; &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;nC: </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;nC&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">8,.0f</span><span class="si">}</span><span class="s2">; &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;a: </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;dminmax&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">5.0f</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;dminmax&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">7.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">runtime</span> <span class="o">+=</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">                **** TOTAL RUNTIME :: &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">runtime</span><span class="o">//</span><span class="mi">60</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> min </span><span class="si">{</span><span class="n">runtime</span><span class="o">%</span><span class="mi">60</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s ****</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Data loaded from «/home/dtr/Desktop/emg3d-gallery/examples/time_domain/Marine-1D.npz»
[emg3d v0.12.0 (format 0.12.0) on 2020-07-29T22:56:01.337841].
    3.176 Hz:  5/1 it;   11 s; a: 1.000 / 1.480 ; nC:  163,840; a:   100 /   24192
    2.004 Hz:  5/1 it;   14 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    1.264 Hz:  6/1 it;   16 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    0.798 Hz:  8/2 it;   22 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    0.503 Hz:  8/2 it;   22 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    0.318 Hz:  9/2 it;   25 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    0.200 Hz: 10/2 it;   27 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    0.126 Hz: 11/2 it;   30 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    0.080 Hz: 11/2 it;   30 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    0.050 Hz: 13/3 it;   35 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    0.032 Hz: 16/3 it;   43 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    0.020 Hz: 16/3 it;   43 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    0.013 Hz: 17/3 it;   45 s; a: 1.000 / 1.480 ; nC:  196,608; a:   100 /   24192
    0.008 Hz: 21/4 it;   55 s; a: 1.000 / 1.490 ; nC:  196,608; a:   100 /   24192
    0.005 Hz: 22/4 it;   78 s; a: 1.000 / 1.480 ; nC:  262,144; a:   100 /   24192
    0.003 Hz: 28/5 it;   99 s; a: 1.000 / 1.480 ; nC:  262,144; a:   100 /   24192

                **** TOTAL RUNTIME :: 9 min 55.0 s ****
</pre></div>
</div>
<div class="section" id="load-data-interpolate-at-receiver-location">
<h3>Load data, interpolate at receiver location<a class="headerlink" href="#load-data-interpolate-at-receiver-location" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initiate data with zeros.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a></a></a></a><span class="p">((</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span><span class="o">.</span><span class="n">size</span></a></a></a></a><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

<span class="c1"># Loop over frequencies.</span>
<span class="k">for</span> <span class="n">fi</span><span class="p">,</span> <span class="n">frq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">frq</span><span class="o">*</span><span class="mf">1e6</span><span class="p">))</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">[</span><span class="n">fi</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="interpolate-missing-frequencies-and-compute-analytical-result">
<h3>Interpolate missing frequencies and compute analytical result<a class="headerlink" href="#interpolate-missing-frequencies-and-compute-analytical-result" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.interpolate" title="emg3d.utils.Fourier.interpolate" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><span class="n">Fourier</span><span class="o">.</span><span class="n">interpolate</span></a></a></a></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">)</span>

<span class="c1"># Compute analytical result using empymod (epm)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">depth</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">depth</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res</span></a></a></a></a><span class="p">,</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">depth</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-frequency-domain-result">
<h3>Plot frequency-domain result<a class="headerlink" href="#plot-frequency-domain-result" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Real, log-lin</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">321</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(a) log-lin Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interpolated&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_x$ (nV/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Real, log-symlog</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">323</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(c) log-symlog Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_x$ (nV/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthreshy</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="c1"># Real, error</span>
<span class="n">ax5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">325</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(e) clipped 0.01-10&#39;</span><span class="p">)</span>

<span class="c1"># Compute the error</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_r</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_r</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc</span><span class="o">.</span><span class="n">real</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Rel. error %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_r</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_r</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.008</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>

<span class="c1"># Imaginary, log-lin</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">322</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(b) log-lin Imag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interpolated&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Imaginary, log-symlog</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">324</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(d) log-symlog Imag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_dense</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_dense</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <span class="mf">1e9</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthreshy</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="c1"># Imaginary, error</span>
<span class="n">ax6</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">326</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(f) clipped 0.01-10&#39;</span><span class="p">)</span>

<span class="c1"># Compute error</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_i</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_int</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_req</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_i</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">)</span> <span class="o">/</span>
                            <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_calc</span><span class="o">.</span><span class="n">imag</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_req" title="emg3d.utils.Fourier.freq_req" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_req</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_int_i</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq_calc" title="emg3d.utils.Fourier.freq_calc" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq_calc</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_cal_i</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.008</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="(a) log-lin Real, (c) log-symlog Real, (e) clipped 0.01-10, (b) log-lin Imag, (d) log-symlog Imag, (f) clipped 0.01-10" class="sphx-glr-single-img" src="../../_images/sphx_glr_marine_1D_002.png" />
</div>
</div>
<div class="section" id="fourier-transform">
<h2>Fourier Transform<a class="headerlink" href="#fourier-transform" title="Permalink to this headline">¶</a></h2>
<p>Carry-out Fourier transform, compute analytical result</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute corresponding time-domain signal.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time</span></a></a></a></a> <span class="o">=</span> <a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.freq2time" title="emg3d.utils.Fourier.freq2time" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-method"><span class="n">Fourier</span><span class="o">.</span><span class="n">freq2time</span></a></a></a></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Analytical result</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">depth</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time</span></a></a></a></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">depth</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">ft</span><span class="o">=</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ft" title="emg3d.utils.Fourier.ft" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ft" title="emg3d.utils.Fourier.ft" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ft" title="emg3d.utils.Fourier.ft" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ft" title="emg3d.utils.Fourier.ft" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">ft</span></a></a></a></a><span class="p">,</span> <span class="n">ftarg</span><span class="o">=</span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ftarg" title="emg3d.utils.Fourier.ftarg" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ftarg" title="emg3d.utils.Fourier.ftarg" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ftarg" title="emg3d.utils.Fourier.ftarg" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Fourier.html#emg3d.utils.Fourier.ftarg" title="emg3d.utils.Fourier.ftarg" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-attribute"><span class="n">Fourier</span><span class="o">.</span><span class="n">ftarg</span></a></a></a></a><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="plot-time-domain-result">
<h3>Plot time-domain result<a class="headerlink" href="#plot-time-domain-result" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># lin-lin</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(a) lin-lin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_x$ (nV/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>

<span class="c1"># log-log</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(b) log-log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;empymod, analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;empymod, same FT as emg3d&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time</span></a></a></a></a><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;emg3d, FFTLog&#39;</span><span class="p">)</span>
<span class="n">perr</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time</span></a></a></a></a><span class="p">)</span><span class="o">-</span><span class="nb">max</span><span class="p">(</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">))</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;k&gt;&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Peak error: </span><span class="si">{</span><span class="n">perr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Error</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(c) clipped 0.01-10 %&#39;</span><span class="p">)</span>

<span class="c1"># Compute error</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_time</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">)</span><span class="o">/</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err2</span></a></a></a></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a></a></a></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time</span></a></a></a></a><span class="o">-</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">)</span><span class="o">/</span><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm_time_precise</span></a></a></a></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err2</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C1.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">time</span></a></a></a></a><span class="p">,</span> <a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://empymod.readthedocs.io/en/stable/code.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err</span></a></a></a></a><span class="p">,</span> <span class="s1">&#39;C0.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Rel. error %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.008</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Plot peak error</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="(a) lin-lin, (b) log-log, (c) clipped 0.01-10 %" class="sphx-glr-single-img" src="../../_images/sphx_glr_marine_1D_003.png" />
</div>
<div class="section" id="further-explanations-to-the-results-in-the-above-figure">
<h3>Further explanations to the results in the above figure:<a class="headerlink" href="#further-explanations-to-the-results-in-the-above-figure" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The black line is a very accurate result using <code class="docutils literal notranslate"><span class="pre">empymod</span></code> and the
following characteristics for the Fourier transform:</p>
<ul>
<li><p>Filter: Key 201 CosSin (2012)</p></li>
<li><p>DLF type: Lagged Convolution</p></li>
<li><p>Required frequencies: 251, from 1.5e-9 to 1.8e6 Hz</p></li>
</ul>
</li>
<li><p>The blue result was equally obtained with <code class="docutils literal notranslate"><span class="pre">empymod</span></code>, but with the
Fourier-transform parameters as used for <code class="docutils literal notranslate"><span class="pre">emg3d</span></code>, hence FFTLog with 5 pts
per decade. However, in contrary to the red response, all frequencies are
computed, with a very high precision.</p></li>
<li><p>The red result is the result obtain with <code class="docutils literal notranslate"><span class="pre">emg3d</span></code>.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Report.html#emg3d.utils.Report" title="emg3d.utils.Report" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Report.html#emg3d.utils.Report" title="emg3d.utils.Report" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Report.html#emg3d.utils.Report" title="emg3d.utils.Report" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><a href="https://emg3d.readthedocs.io/en/stable/api/emg3d.utils.Report.html#emg3d.utils.Report" title="emg3d.utils.Report" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Report</span></a></a></a></a><span class="p">()</span>
</pre></div>
</div>
<table style='border: 3px solid #ddd;'>
  <tr>
     <td style='text-align: center; font-weight: bold; font-size: 1.2em; border: 2px solid #fff;' colspan='6'>Wed Jul 29 22:56:05 2020 CEST</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>OS</td>
    <td style='text-align: left; border: 2px solid #fff;'>Linux</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>CPU(s)</td>
    <td style='text-align: left; border: 2px solid #fff;'>4</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Machine</td>
    <td style='text-align: left; border: 2px solid #fff;'>x86_64</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Architecture</td>
    <td style='text-align: left; border: 2px solid #fff;'>64bit</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>RAM</td>
    <td style='text-align: left; border: 2px solid #fff;'>15.5 GB</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Environment</td>
    <td style='text-align: left; border: 2px solid #fff;'>Python</td>
  </tr>
  <tr>
     <td style='text-align: center; border: 2px solid #fff;' colspan='6'>Python 3.8.3 (default, Jul  2 2020, 16:21:59)
[GCC 7.3.0]</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>numpy</td>
    <td style='text-align: left; border: 2px solid #fff;'>1.18.5</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>scipy</td>
    <td style='text-align: left; border: 2px solid #fff;'>1.5.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>numba</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.50.1</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>emg3d</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.12.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>empymod</td>
    <td style='text-align: left; border: 2px solid #fff;'>2.0.2</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>xarray</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.16.0</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>discretize</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.4.15</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>h5py</td>
    <td style='text-align: left; border: 2px solid #fff;'>2.10.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>matplotlib</td>
    <td style='text-align: left; border: 2px solid #fff;'>3.2.2</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>IPython</td>
    <td style='text-align: left; border: 2px solid #fff;'>7.16.1</td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
  </tr>
  <tr>
     <td style='text-align: center; background-color: #ddd;border: 2px solid #fff;' colspan='6'>Intel(R) Math Kernel Library Version 2020.0.1 Product Build 20200208 for Intel(R) 64 architecture applications</td>
  </tr>
</table>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 10 minutes  2.640 seconds)</p>
<p><strong>Estimated memory usage:</strong>  9 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-time-domain-marine-1d-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/f711e69f375583366a5c6564a2a55c41/marine_1D.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">marine_1D.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/6ba1707b355e0b8959b2db5935af588e/marine_1D.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">marine_1D.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="freqselect.html" class="btn btn-neutral float-right" title="3. Interactive frequency selection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fullspace.html" class="btn btn-neutral float-left" title="1. Transient CSEM for a homogeneous space" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2020, The emg3d Developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>